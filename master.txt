modified and merged to private